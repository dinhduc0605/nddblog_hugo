<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano - NDDBlog</title><meta name="Description" content="Những mẩu chuyện nhỏ của Đức"><meta property="og:title" content="Deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano" />
<meta property="og:description" content="Xin chào các bạn, có lẽ cũng gần nửa năm rồi mình chưa viết bài mới nhỉ. Hôm nay do thời hạn dùng thử của Amazon free tier đã hết mình mất cả buổi sáng đổi server của blog qua bên Vultr. Do tốn khá nhiều thời gian và công sức nên nhân dịp này mình muốn viết 1 bài để chia sẽ với các bạn cách deploy ứng dụng Rails lên server Ubuntu 18." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nddblog.com/posts/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano/" /><meta property="og:image" content="https://nddblog.com/logo.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-24T22:27:08+09:00" />
<meta property="article:modified_time" content="2024-02-24T22:27:55+09:00" /><meta property="og:site_name" content="NDDBlog" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://nddblog.com/logo.png" /><meta name="twitter:title" content="Deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano"/>
<meta name="twitter:description" content="Xin chào các bạn, có lẽ cũng gần nửa năm rồi mình chưa viết bài mới nhỉ. Hôm nay do thời hạn dùng thử của Amazon free tier đã hết mình mất cả buổi sáng đổi server của blog qua bên Vultr. Do tốn khá nhiều thời gian và công sức nên nhân dịp này mình muốn viết 1 bài để chia sẽ với các bạn cách deploy ứng dụng Rails lên server Ubuntu 18."/>
<meta name="application-name" content="NDDBlog">
<meta name="apple-mobile-web-app-title" content="NDDBlog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://nddblog.com/posts/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano/" /><link rel="prev" href="https://nddblog.com/posts/cach-tao-nhieu-co-so-du-lieu-tren-circleci/" /><link rel="next" href="https://nddblog.com/posts/phan-1-doi-song-nhat-ban-5-nam-1-chang-duong/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/nddblog.com\/posts\/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano\/"
        },"genre": "posts","wordcount":  1164 ,
        "url": "https:\/\/nddblog.com\/posts\/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano\/","datePublished": "2024-02-24T22:27:08+09:00","dateModified": "2024-02-24T22:27:55+09:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Dinh Duc"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="NDDBlog">NDDBlog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="NDDBlog">NDDBlog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/about" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Dinh Duc</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-02-24">2024-02-24</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1164 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="true">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents"></nav></div>
            </div><div class="content" id="content"><p>Xin chào các bạn, có lẽ cũng gần nửa năm rồi mình chưa viết bài mới nhỉ. Hôm nay do thời hạn dùng thử của Amazon free tier đã hết mình mất cả buổi sáng đổi server của blog qua bên Vultr. Do tốn khá nhiều thời gian và công sức nên nhân dịp này mình muốn viết 1 bài để chia sẽ với các bạn cách deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano</p>
<p>Trước khi bắt tay vào cài đặt bạn cần có các điều kiện dưới đây:</p>
<ul>
<li>Server Ubuntu 18.04. Mình đang sử dụng server của <a href="https://www.vultr.com/" target="_blank" rel="noopener noreffer ">Vultr</a>. Theo mình tìm hiểu thì hiện tại đang là rẻ nhất trong số các nhà cung cấp VPS có uy tín ( 3.5$/tháng ).</li>
<li>Ứng dụng Rails sẵn sàng để deploy.</li>
</ul>
<h1 id="bước-1-cài-đặt-nginx">Bước 1: Cài đặt Nginx</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">apt</span> <span class="nx">update</span>
</span></span><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">apt</span> <span class="nx">install</span> <span class="nx">nginx</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="bước-2-cài-đặt-database-postgres">Bước 2: Cài đặt database (Postgres)</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">apt</span> <span class="nx">update</span>
</span></span><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">apt</span> <span class="nx">install</span> <span class="nx">postgresql</span> <span class="nx">postgresql</span><span class="o">-</span><span class="nx">contrib</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Khi deploy Capistrano chỉ chạy lệnh db:migrate, vì vậy các bạn cần tạo sẵn database để deploy được suôn sẻ.</p>
<p>Vào PostgresSQL prompt bằng các lệnh sau:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="o">-</span><span class="nx">i</span> <span class="o">-</span><span class="nx">u</span> <span class="nx">postgres</span>
</span></span><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">psql</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Sau đó ta tạo cơ sở dữ liệu db_name (tên database được định nghĩ trong file database.yml)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">postgres</span><span class="o">=</span><span class="err">$</span> <span class="nx">CREATE</span> <span class="nx">DATABASE</span> <span class="nx">db_name</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Để chạy được lệnh db:migrate ta cần có database role, vì vậy ta tạo role như sau (username và password được định nghĩa trong file database.yml) :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">postgres</span><span class="o">=</span><span class="err">$</span> <span class="nx">CREATE</span> <span class="nx">USER</span> <span class="nx">username</span> <span class="nx">WITH</span> <span class="nx">PASSWORD</span> <span class="s1">&#39;password&#39;</span><span class="p">;</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Cấp quyền cho user để có thể thao tác với database</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">postgres</span><span class="o">=</span><span class="err">$</span> <span class="nx">GRANT</span> <span class="nx">ALL</span> <span class="nx">PRIVILEGES</span> <span class="nx">ON</span> <span class="nx">DATABASE</span> <span class="s1">&#39;db_name&#39;</span> <span class="nx">to</span> <span class="nx">username</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="bước-3-cài-đặt-rvm">Bước 3: Cài đặt RVM</h1>
<p>Đầu tiên ta phải cài đặt GPG keys</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">gpg</span> <span class="o">--</span><span class="nx">keyserver</span> <span class="nx">hkp</span><span class="o">://</span><span class="nx">pool</span><span class="o">.</span><span class="nx">sks</span><span class="o">-</span><span class="nx">keyservers</span><span class="o">.</span><span class="nx">net</span> <span class="o">--</span><span class="nx">recv</span><span class="o">-</span><span class="nx">keys</span> <span class="mi">409</span><span class="nx">B6B1796C275462A1703113804BB82D39DC0E3</span> <span class="mi">7</span><span class="nx">D2BAF1CF37B13E2069D6956105BD0E739499BDB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Sau đó thực hiện các câu lệnh sau để cài đặt RVM</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="nx">get</span> <span class="nx">install</span> <span class="nx">software</span><span class="o">-</span><span class="nx">properties</span><span class="o">-</span><span class="nx">common</span>
</span></span><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="nx">add</span><span class="o">-</span><span class="nx">repository</span> <span class="o">-</span><span class="nx">y</span> <span class="nx">ppa</span><span class="o">:</span><span class="nx">rael</span><span class="o">-</span><span class="nx">gc</span><span class="o">/</span><span class="nx">rvm</span>
</span></span><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="nx">get</span> <span class="nx">update</span>
</span></span><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">apt</span><span class="o">-</span><span class="nx">get</span> <span class="nx">install</span> <span class="nx">rvm</span>
</span></span><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="k">echo</span> <span class="s1">&#39;source &#34;/etc/profile.d/rvm.sh&#34;&#39;</span> <span class="o">&gt;&gt;</span> <span class="o">~/.</span><span class="nx">bashrc</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Cài đặt ruby 2.5.3</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">rvm</span> <span class="nx">install</span> <span class="mf">2.5</span><span class="o">.</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">rvm</span> <span class="k">use</span> <span class="mf">2.5</span><span class="o">.</span><span class="mi">3</span> <span class="o">--</span><span class="k">default</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="bước-4-thiết-lập-ssh-keys">Bước 4: Thiết lập SSH keys</h1>
<p>Khi deploy ứng dụng lên server ta cần clone code của ứng dụng từ Github (Bitbucket, Gitlab&hellip;). Để clone code mà không cần phải nhập mật khẩu (thông qua SSH protocol, không phải HTTP) ta cần tạo SSH key.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">ssh</span><span class="o">-</span><span class="nx">keygen</span> <span class="o">-</span><span class="nx">t</span> <span class="nx">rsa</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Nếu không cần cài đặt gì đặc biết các bạn chỉ việc enter. Sau đó sẽ có 2 file được tạo ra tại thư mục <code>~/.ssh/</code>là <code>id_rsa.pub</code> và <code>id_rsa</code>. Sau đó bạn thêm <code>id_rsa.pub</code> vào deployment keys theo hướng dẫn sau <a href="https://docs.github.com/en/developers/overview/managing-deploy-keys#setup-2" target="_blank" rel="noopener noreffer ">(Cài đặt)</a></p>
<p>Đến đây đã thành công thì sẽ hiển thị như sau</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">ssh</span> <span class="o">-</span><span class="nx">T</span> <span class="nx">git</span><span class="o">@</span><span class="nx">github</span><span class="o">.</span><span class="nx">com</span>
</span></span><span class="line"><span class="cl"><span class="o">=&gt;</span> <span class="nx">Hi</span> <span class="nx">dinhduc0605</span><span class="o">!</span> <span class="nx">You</span><span class="err">&#39;</span><span class="nx">ve</span> <span class="nx">successfully</span> <span class="nx">authenticated</span><span class="p">,</span> <span class="nx">but</span> <span class="nx">GitHub</span> <span class="nx">does</span> <span class="k">not</span> <span class="nx">provide</span> <span class="nx">shell</span> <span class="nx">access</span><span class="o">.</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Nếu trên máy local của bạn chưa có ssh keys, bạn cũng làm như trên để tạo key mới. Sau đó thêm khoá công khai vào Authorized Keys file trên server.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">cat</span> <span class="o">~/.</span><span class="nx">ssh</span><span class="o">/</span><span class="nx">id_rsa</span><span class="o">.</span><span class="nx">pub</span> <span class="o">|</span> <span class="nx">ssh</span> <span class="o">-</span><span class="nx">p</span> <span class="nx">your_port_num</span> <span class="nx">deploy</span><span class="o">@</span><span class="nx">your_server_ip</span> <span class="s1">&#39;cat &gt;&gt; ~/.ssh/authorized_keys&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="bước-5-config-capistrano-và-nginx">Bước 5: Config Capistrano và Nginx</h1>
<p>Đầu tiên ta thêm các gem sau vào group :development trong Gemfile:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">group</span> <span class="o">:</span><span class="nx">development</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nx">gem</span> <span class="s1">&#39;capistrano&#39;</span><span class="p">,</span>         <span class="k">require</span><span class="o">:</span> <span class="k">false</span>
</span></span><span class="line"><span class="cl">    <span class="nx">gem</span> <span class="s1">&#39;capistrano-rvm&#39;</span><span class="p">,</span>     <span class="k">require</span><span class="o">:</span> <span class="k">false</span>
</span></span><span class="line"><span class="cl">    <span class="nx">gem</span> <span class="s1">&#39;capistrano-rails&#39;</span><span class="p">,</span>   <span class="k">require</span><span class="o">:</span> <span class="k">false</span>
</span></span><span class="line"><span class="cl">    <span class="nx">gem</span> <span class="s1">&#39;capistrano-bundler&#39;</span><span class="p">,</span> <span class="k">require</span><span class="o">:</span> <span class="k">false</span>
</span></span><span class="line"><span class="cl">    <span class="nx">gem</span> <span class="s1">&#39;capistrano3-puma&#39;</span><span class="p">,</span>   <span class="k">require</span><span class="o">:</span> <span class="k">false</span>
</span></span><span class="line"><span class="cl"><span class="nx">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Sử dụng bundler để cài đặt các gem đó</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">bundle</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Sau đó thực hiện lệnh sau để config Capistrano:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">cap</span> <span class="nx">install</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Các file sau tự động được tạo ra:</p>
<ul>
<li><code>Capfile</code>: load các task đã được định nghĩa sẵn như: chọn Ruby version, precompile assest, clone git repo&hellip;</li>
<li><code>config/deploy.rb</code>: cấu hình các task dùng để deploy lên server như truy cập server qua ssh, quản lý các file logs&hellip;</li>
<li><code>config</code>: thư mục chứa file config cho  loại môi trường như staging, production.</li>
</ul>
<p>Thay thế nội dung file <code>Capfile</code> như sau:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1"># frozen_string_literal: true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1"># Load DSL and Setup Up Stages
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">require</span> <span class="s1">&#39;capistrano/setup&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;capistrano/deploy&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;capistrano/rails&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;capistrano/bundler&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;capistrano/rvm&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s2">&#34;capistrano/scm/git&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">install_plugin</span> <span class="nx">Capistrano</span><span class="o">::</span><span class="na">SCM</span><span class="o">::</span><span class="na">Git</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;capistrano/puma&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">install_plugin</span> <span class="nx">Capistrano</span><span class="o">::</span><span class="na">Puma</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Loads custom tasks from `lib/capistrano/tasks&#39; if you have any defined.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">Dir</span><span class="o">.</span><span class="nx">glob</span><span class="p">(</span><span class="s1">&#39;lib/capistrano/tasks/*.rake&#39;</span><span class="p">)</span><span class="o">.</span><span class="nx">each</span> <span class="p">{</span> <span class="o">|</span><span class="nx">r</span><span class="o">|</span> <span class="nx">import</span> <span class="nx">r</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Thay thế các thông số sau tương ứng với ứng dụng của mình. Phần còn lại thì giữ nguyên không đổi.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1"># frozen_string_literal: true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1"># Change these
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">server</span> <span class="s1">&#39;your_server_ip&#39;</span><span class="p">,</span> <span class="nx">port</span><span class="o">:</span> <span class="nx">your_port_num</span><span class="p">,</span> <span class="nx">roles</span><span class="o">:</span> <span class="p">[</span><span class="o">:</span><span class="nx">web</span><span class="p">,</span> <span class="o">:</span><span class="nx">app</span><span class="p">,</span> <span class="o">:</span><span class="nx">db</span><span class="p">],</span> <span class="nx">primary</span><span class="o">:</span> <span class="k">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">set</span> <span class="o">:</span><span class="nx">repo_url</span><span class="p">,</span>        <span class="s1">&#39;git@example.com:username/appname.git&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">set</span> <span class="o">:</span><span class="nx">application</span><span class="p">,</span>     <span class="s1">&#39;appname&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">set</span> <span class="o">:</span><span class="nx">user</span><span class="p">,</span>            <span class="s1">&#39;deploy&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">set</span> <span class="o">:</span><span class="nx">puma_threads</span><span class="p">,</span>    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">set</span> <span class="o">:</span><span class="nx">puma_workers</span><span class="p">,</span>    <span class="mi">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Tiếp theo ta cần cấu hình nginx để lắng nghe các request từ port 80 và chuyển tới Puma socket. Tạo file nginx.conf tại thư mục config (thay thế server_username và appname tương ứng):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">upstream</span> <span class="nx">puma</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">server</span> <span class="nx">unix</span><span class="o">:///</span><span class="nx">home</span><span class="o">/</span><span class="nx">deploy</span><span class="o">/</span><span class="nx">apps</span><span class="o">/</span><span class="nx">appname</span><span class="o">/</span><span class="nx">shared</span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">sockets</span><span class="o">/</span><span class="nx">appname</span><span class="o">-</span><span class="nx">puma</span><span class="o">.</span><span class="nx">sock</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">listen</span> <span class="mi">80</span> <span class="nx">default_server</span> <span class="nx">deferred</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># server_name example.com;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">root</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">deploy</span><span class="o">/</span><span class="nx">apps</span><span class="o">/</span><span class="nx">appname</span><span class="o">/</span><span class="nx">current</span><span class="o">/</span><span class="k">public</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">access_log</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">deploy</span><span class="o">/</span><span class="nx">apps</span><span class="o">/</span><span class="nx">appname</span><span class="o">/</span><span class="nx">current</span><span class="o">/</span><span class="nx">log</span><span class="o">/</span><span class="nx">nginx</span><span class="o">.</span><span class="nx">access</span><span class="o">.</span><span class="nx">log</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">error_log</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">deploy</span><span class="o">/</span><span class="nx">apps</span><span class="o">/</span><span class="nx">appname</span><span class="o">/</span><span class="nx">current</span><span class="o">/</span><span class="nx">log</span><span class="o">/</span><span class="nx">nginx</span><span class="o">.</span><span class="nx">error</span><span class="o">.</span><span class="nx">log</span> <span class="nx">info</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">location</span> <span class="o">^~</span> <span class="o">/</span><span class="nx">assets</span><span class="o">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">gzip_static</span> <span class="nx">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">expires</span> <span class="nx">max</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">add_header</span> <span class="nx">Cache</span><span class="o">-</span><span class="nx">Control</span> <span class="k">public</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">try_files</span> <span class="nv">$uri</span><span class="o">/</span><span class="nx">index</span><span class="o">.</span><span class="nx">html</span> <span class="nv">$uri</span> <span class="o">@</span><span class="nx">puma</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">location</span> <span class="o">@</span><span class="nx">puma</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">proxy_set_header</span> <span class="nx">X</span><span class="o">-</span><span class="nx">Forwarded</span><span class="o">-</span><span class="k">For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">proxy_set_header</span> <span class="nx">Host</span> <span class="nv">$http_host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">proxy_redirect</span> <span class="nx">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">proxy_pass</span> <span class="nx">http</span><span class="o">://</span><span class="nx">puma</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">error_page</span> <span class="mi">500</span> <span class="mi">502</span> <span class="mi">503</span> <span class="mi">504</span> <span class="o">/</span><span class="mf">500.</span><span class="nx">html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">client_max_body_size</span> <span class="mi">10</span><span class="nx">M</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">keepalive_timeout</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="bước-6-deploy-ứng-dụng">Bước 6: Deploy ứng dụng</h1>
<p>Các bạn tạo commit và push lên nhánh master như sau:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">git</span> <span class="nx">add</span> <span class="o">-</span><span class="nx">A</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">git</span> <span class="nx">commit</span> <span class="o">-</span><span class="nx">m</span> <span class="s2">&#34;Set up Puma, Nginx &amp; Capistrano&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">git</span> <span class="nx">push</span> <span class="nx">origin</span> <span class="nx">master</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Sau đó deploy lần đầu tiên với capistrano:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">cap</span> <span class="nx">production</span> <span class="nx">deploy</span><span class="o">:</span><span class="nx">initial</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Lệnh này sẽ tự động deploy ứng dụng của bạn lên server, cài đặt các gem cần thiết và khởi động puma server. Quá trình sẽ mất khoảng 5-15 phút.</p>
<p>Nếu mọi thứ suôn sẻ tiếp đến bạn cần symlink file nginx.conf trong ứng dụng Rails tới thư mục <code>sites-enabled</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">rm</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">nginx</span><span class="o">/</span><span class="nx">sites</span><span class="o">-</span><span class="nx">enabled</span><span class="o">/</span><span class="k">default</span>
</span></span><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">ln</span> <span class="o">-</span><span class="nx">nfs</span> <span class="s2">&#34;/home/server_username/apps/appname/current/config/nginx.conf&#34;</span> <span class="s2">&#34;/etc/nginx/sites-enabled/appname&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Khởi động lại Nginx:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">deploy</span><span class="o">@</span><span class="nx">vultr</span><span class="o">:~</span><span class="err">$</span> <span class="nx">sudo</span> <span class="nx">service</span> <span class="nx">nginx</span> <span class="nx">restart</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Tới đây các bạn đã có thể truy cập website của mình thông qua IP của server rồi.
Với các lần deploy tiếp theo các bạn chỉ cần chạy lệnh sau là đủ (lưu ý nếu bạn thay đổi file config/nginx.conf thì cần phải khởi động lại Nginx):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="err">$</span> <span class="nx">cap</span> <span class="nx">production</span> <span class="nx">deploy</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="tổng-kết">Tổng kết</h1>
<p>Như vậy mình đã hướng dẫn các bạn deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano. Hi vọng các bạn thành công!!!
Với các bạn có server dụng lượng bộ nhớ thấp khi deploy có khả năng bị lỗi thì có thể tham khảo bài viết sau:</p>
<ul>
<li>Thêm không gian Swap trên Server Ubuntu 18.04 (comming soon)</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-02-24&nbsp;<a class="git-hash" href="https://github.com/dinhduc0605/nddblog_hugo/commit/d4f076ecbcaef1476761ac4b4bb489b5e2edd3e5" target="_blank" title="commit by Dinh Duc(dinhduc0605@gmail.com) d4f076ecbcaef1476761ac4b4bb489b5e2edd3e5: write post about deploying rails">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>d4f076e</a></span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/posts/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://nddblog.com/posts/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano/" data-title="Deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://nddblog.com/posts/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://nddblog.com/posts/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano/" data-title="Deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://nddblog.com/posts/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano/" data-title="Deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://nddblog.com/posts/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano/" data-title="Deploy ứng dụng Rails lên server Ubuntu 18.04 với Puma, Nginx và Capistrano"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/cach-tao-nhieu-co-so-du-lieu-tren-circleci/" class="prev" rel="prev" title="Cách tạo nhiều cơ sở dữ liệu trên CircleCI"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Cách tạo nhiều cơ sở dữ liệu trên CircleCI</a>
            <a href="/posts/phan-1-doi-song-nhat-ban-5-nam-1-chang-duong/" class="next" rel="next" title="[Phần 1 - Đời sống] Nhật Bản - 5 năm 1 chặng đường">[Phần 1 - Đời sống] Nhật Bản - 5 năm 1 chặng đường<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript><div id="fb-root" class="comment"></div>
            <div
                class="fb-comments"
                data-href="https://nddblog.com/posts/deploy-rails-len-server-ubuntu-voi-puma-nginx-capistrano/"
                data-width="100%"
                data-numposts="10"
            ></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://developers.facebook.com/docs/plugins/comments/"></a>Facebook</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.123.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/about" target="_blank">Dinh Duc</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="https://.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v5.0&appId=&autoLogAppEvents=1" defer></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
